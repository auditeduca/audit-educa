<!DOCTYPE html>
<html lang="pt-br" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Calculadora Profissional de Juros Simples - Audit Educa">
    <meta name="application-name" content="Audit Educa Tools">
    <title>Calculadora Juros Simples | Audit Educa</title>
    
    <!-- === BIBLIOTECAS EXTERNAS === -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.3.6/dist/driver.css">
    <script src="https://cdn.jsdelivr.net/npm/driver.js@1.3.6/dist/driver.js.iife.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- === INTEGRAÇÃO AUDIT EDUCA (CSS) === -->
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/header.css">
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/footer.css">

    <!-- === SCRIPTS DE INTEGRAÇÃO (JS) === -->
    <!-- Adicionado crossorigin para melhor reporte de erros se o servidor permitir -->
    <script src="https://auditeduca.com.br/assets/js/header.js" defer crossorigin="anonymous"></script>
    <script src="https://auditeduca.com.br/assets/js/footer.js" defer crossorigin="anonymous"></script>
    <script src="https://auditeduca.com.br/accessibility-api.js" defer crossorigin="anonymous"></script>

    <!-- === CONFIGURAÇÃO TAILWIND === -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        serif: ['Playfair Display', 'Georgia', 'serif'],
                    },
                    colors: {
                        'audit-gold': '#C5A059',
                        'audit-navy': '#0f172a',
                        'audit-blue': '#1e40af',
                        'audit-gray': '#f8fafc',
                    },
                    zIndex: {
                        'drawer': '60',
                        'overlay': '55',
                        'header': '50',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- === CSS PERSONALIZADO DA CALCULADORA === -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #334155; }
        
        .bg-grid-pattern {
            background-color: #f8fafc;
            background-image: linear-gradient(#e2e8f0 1px, transparent 1px), linear-gradient(90deg, #e2e8f0 1px, transparent 1px);
            background-size: 40px 40px;
        }

        .btn-spinner {
            display: none; width: 16px; height: 16px; margin-right: 8px;
            border: 2px solid currentColor; border-top-color: transparent;
            border-radius: 50%; animation: spin 0.8s linear infinite;
        }
        .btn-loading .btn-spinner { display: inline-block; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .drawer-overlay {
            position: fixed; inset: 0; background: rgba(15, 23, 42, 0.4); 
            backdrop-filter: blur(2px); z-index: 55; opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .drawer-overlay.open { opacity: 1; pointer-events: auto; }
        
        .right-drawer {
            position: fixed; top: 0; right: 0; height: 100vh; width: 100%; max-width: 400px;
            background: white; z-index: 60; transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: -10px 0 30px rgba(0,0,0,0.1); display: flex; flex-direction: column;
        }
        .right-drawer.open { transform: translateX(0); }

        .custom-input {
            width: 100%; border-radius: 0.5rem; border: 1px solid #cbd5e1; padding: 0.75rem 1rem;
            transition: all 0.2s; font-weight: 500; color: #334155;
        }
        .custom-input:focus {
            outline: none; border-color: #1e40af; box-shadow: 0 0 0 4px rgba(30, 64, 175, 0.1);
        }

        @media print {
            .no-print { display: none !important; }
            body, .bg-grid-pattern { background: white !important; }
            .shadow-lg, .shadow-sm { box-shadow: none !important; }
            #box-resultado { break-inside: avoid; background-color: #fff !important; color: #000 !important; border: 1px solid #000; }
            #box-resultado * { color: #000 !important; }
            .print-header { display: block !important; }
            #header-placeholder, #footer-placeholder { display: none !important; }
        }
        .print-header { display: none; margin-bottom: 2rem; border-bottom: 2px solid #000; padding-bottom: 1rem; }
    </style>
</head>
<body class="flex flex-col min-h-screen bg-grid-pattern relative">

    <!-- === 1. HEADER === -->
    <div id="header-placeholder" class="no-print sticky top-0 z-header bg-white min-h-[80px]"></div>

    <!-- === 2. CONTEÚDO PRINCIPAL === -->
    <main class="flex-grow py-8 px-4 sm:px-6 lg:px-8 w-full z-0">
        
        <div class="print-header">
            <h1 class="text-2xl font-bold">Relatório de Cálculo - Juros Simples</h1>
            <p class="text-sm">Gerado por Audit Educa Tools em <span id="print-date"></span></p>
        </div>

        <div class="max-w-7xl mx-auto">
            
            <div class="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10 no-print">
                <div>
                    <nav class="flex mb-3 text-xs text-slate-500" aria-label="Breadcrumb">
                        <ol class="inline-flex items-center space-x-1 md:space-x-2">
                            <li><a href="index.html" class="hover:text-audit-blue">Home</a></li>
                            <li><i data-lucide="chevron-right" class="w-3 h-3"></i></li>
                            <li><span class="text-audit-navy font-medium">Juros Simples</span></li>
                        </ol>
                    </nav>
                    <div class="inline-flex items-center gap-2 mb-2">
                        <span class="h-px w-8 bg-audit-gold"></span>
                        <span class="text-xs font-bold uppercase tracking-widest text-audit-gold">Matemática Financeira</span>
                    </div>
                    <h1 id="page-title" class="text-3xl md:text-4xl font-serif font-bold text-audit-navy leading-tight">
                        Calculadora de Juros Simples
                    </h1>
                </div>
                
                <div class="flex items-center gap-3">
                    <button onclick="AuditCalculadora.toggleDrawer('referencias')" class="text-slate-500 hover:text-audit-blue transition px-3 py-2 border border-slate-200 rounded-md text-sm flex items-center gap-2 bg-white" title="Referências Técnicas">
                        <i data-lucide="book-open" class="w-4 h-4"></i> Referências
                    </button>
                    <button onclick="AuditCalculadora.startTour()" class="hidden sm:flex items-center gap-2 px-4 py-2 text-xs font-bold text-audit-navy bg-slate-100 rounded-full hover:bg-slate-200 transition">
                        <i data-lucide="play-circle" class="w-4 h-4"></i> Guia Rápido
                    </button>
                </div>
            </div>

            <div class="lg:grid lg:grid-cols-12 lg:gap-10">
                
                <div class="lg:col-span-8 space-y-8" id="main-content">
                    
                    <section id="calc-card" class="bg-white border border-gray-200 rounded-xl p-6 sm:p-8 shadow-sm relative overflow-hidden group hover:border-audit-blue/30 transition-all duration-300">
                        <div class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-audit-navy to-audit-blue"></div>
                        
                        <form id="form-calculadora" class="space-y-6 mt-2">
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                                <div class="col-span-1 sm:col-span-2">
                                    <label class="block text-sm font-semibold text-audit-navy mb-2">
                                        Capital Inicial (VP) <span class="text-red-500">*</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 font-bold sm:text-sm">R$</span>
                                        </div>
                                        <input type="text" id="principal" class="custom-input pl-10" placeholder="0,00" oninput="AuditCalculadora.formatCurrency(this)">
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold text-audit-navy mb-2">
                                        Taxa de Juros (%) <span class="text-red-500">*</span>
                                    </label>
                                    <div class="relative">
                                        <input type="number" id="taxa" step="0.01" class="custom-input pr-20" placeholder="Ex: 1.0">
                                        <div class="absolute inset-y-0 right-0 flex items-center pr-1">
                                            <select id="tipo-taxa" class="h-full py-0 pl-2 pr-7 bg-transparent border-0 text-gray-500 font-medium text-sm focus:ring-0 cursor-pointer">
                                                <option value="mensal">a.m.</option>
                                                <option value="anual">a.a.</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold text-audit-navy mb-2">
                                        Período <span class="text-red-500">*</span>
                                    </label>
                                    <div class="relative">
                                        <input type="number" id="periodo" step="1" class="custom-input pr-24" placeholder="Ex: 12">
                                        <div class="absolute inset-y-0 right-0 flex items-center pr-1">
                                            <select id="tipo-periodo" class="h-full py-0 pl-2 pr-7 bg-transparent border-0 text-gray-500 font-medium text-sm focus:ring-0 cursor-pointer">
                                                <option value="meses">Meses</option>
                                                <option value="anos">Anos</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4 no-print">
                                <button type="submit" id="btn-calcular" class="flex items-center justify-center gap-2 h-12 bg-audit-navy text-white font-bold rounded-lg hover:bg-slate-800 transition-all shadow-md active:scale-95">
                                    <span class="btn-spinner"></span>
                                    <i data-lucide="calculator" class="w-4 h-4"></i> <span>Calcular</span>
                                </button>
                                
                                <button type="button" id="btn-limpar" class="flex items-center justify-center gap-2 h-12 bg-white border border-slate-300 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-all">
                                    <span class="btn-spinner"></span>
                                    <i data-lucide="rotate-ccw" class="w-4 h-4"></i> <span>Limpar</span>
                                </button>
                            </div>
                        </form>
                    </section>

                    <section id="box-resultado" class="hidden animate-fade-in space-y-4">
                        <div class="bg-audit-navy text-white rounded-xl p-8 shadow-lg relative overflow-hidden">
                            <div class="absolute top-0 right-0 -mt-6 -mr-6 w-32 h-32 bg-white opacity-5 rounded-full blur-2xl"></div>
                            <div class="absolute bottom-0 left-0 -mb-6 -ml-6 w-24 h-24 bg-audit-gold opacity-10 rounded-full blur-xl"></div>
                            
                            <div class="relative z-10">
                                <h3 class="text-xs font-bold text-audit-gold uppercase tracking-widest mb-6">Resultado Consolidado</h3>
                                
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-8">
                                    <div>
                                        <span class="text-slate-400 text-sm block mb-1">Montante Final (M)</span>
                                        <span class="text-4xl font-serif font-bold text-white tracking-tight block" id="res-montante">R$ 0,00</span>
                                    </div>
                                    <div class="sm:border-l sm:border-slate-700 sm:pl-8">
                                        <span class="text-slate-400 text-sm block mb-1">Total em Juros (J)</span>
                                        <span class="text-3xl font-serif font-bold text-audit-gold tracking-tight block" id="res-juros">R$ 0,00</span>
                                    </div>
                                </div>

                                <div class="mt-8 pt-6 border-t border-white/10 flex flex-wrap gap-4 text-sm text-slate-300">
                                    <div class="flex items-center gap-2">
                                        <i data-lucide="percent" class="w-4 h-4 text-audit-gold"></i>
                                        Taxa Efetiva: <span id="res-taxa-efetiva" class="text-white font-bold">0%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 no-print">
                            <button id="btn-copiar" onclick="AuditCalculadora.copyResult()" class="h-12 flex items-center justify-center gap-2 bg-white border border-gray-200 rounded-lg text-sm font-medium text-slate-600 hover:text-audit-blue hover:border-audit-blue transition-colors group">
                                <span class="btn-spinner"></span>
                                <i data-lucide="copy" class="w-4 h-4 group-hover:scale-110 transition-transform"></i> Copiar
                            </button>
                            <button id="btn-pdf" onclick="AuditCalculadora.generatePDF()" class="h-12 flex items-center justify-center gap-2 bg-white border border-gray-200 rounded-lg text-sm font-medium text-slate-600 hover:text-red-600 hover:border-red-200 transition-colors group">
                                <span class="btn-spinner"></span>
                                <i data-lucide="file-down" class="w-4 h-4 group-hover:scale-110 transition-transform"></i> PDF
                            </button>
                        </div>
                    </section>
                </div>

                <aside class="lg:col-span-4 mt-8 lg:mt-0 space-y-6 no-print">
                    <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm lg:sticky lg:top-24">
                        <div class="flex items-center gap-2 mb-4 pb-2 border-b border-gray-100">
                            <i data-lucide="list" class="w-4 h-4 text-audit-gold"></i>
                            <span class="text-sm font-bold text-audit-navy uppercase">Nesta Página</span>
                        </div>
                        <nav id="toc-right" class="space-y-1">
                            <a href="#form-calculadora" class="block py-2 px-3 rounded text-sm text-slate-600 hover:bg-slate-50 hover:text-audit-blue transition-colors">Calculadora</a>
                            <a href="#box-resultado" class="block py-2 px-3 rounded text-sm text-slate-600 hover:bg-slate-50 hover:text-audit-blue transition-colors">Resultado</a>
                            <button onclick="AuditCalculadora.toggleDrawer('referencias')" class="w-full text-left py-2 px-3 rounded text-sm text-slate-600 hover:bg-slate-50 hover:text-audit-blue transition-colors">Referências</button>
                        </nav>
                    </div>

                    <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm">
                        <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">Compartilhar</h4>
                        <div class="flex flex-wrap gap-2">
                            <button class="w-9 h-9 rounded bg-[#1877F2] text-white flex items-center justify-center hover:opacity-90 transition"><i class="fab fa-facebook-f text-sm"></i></button>
                            <button class="w-9 h-9 rounded bg-[#25D366] text-white flex items-center justify-center hover:opacity-90 transition"><i class="fab fa-whatsapp text-sm"></i></button>
                            <button class="w-9 h-9 rounded bg-[#0A66C2] text-white flex items-center justify-center hover:opacity-90 transition"><i class="fab fa-linkedin-in text-sm"></i></button>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </main>

    <!-- === 3. FOOTER === -->
    <div id="footer-placeholder" class="no-print mt-auto"></div>

    <!-- === DRAWERS === -->
    <div id="drawer-overlay" class="drawer-overlay" onclick="AuditCalculadora.closeDrawers()"></div>

    <aside id="drawer-referencias" class="right-drawer">
        <div class="p-5 border-b border-gray-100 flex items-center justify-between bg-white sticky top-0 z-10">
            <h3 class="font-bold text-audit-navy flex items-center gap-2">
                <i data-lucide="book-open" class="w-5 h-5 text-audit-blue"></i> Referências
            </h3>
            <button onclick="AuditCalculadora.closeDrawers()" class="p-2 hover:bg-slate-100 rounded-full text-slate-400 transition">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>
        </div>
        <div class="p-6 overflow-y-auto space-y-6">
            <div class="prose prose-sm text-slate-600">
                <p>O regime de <strong>Juros Simples</strong> considera que a taxa incide apenas sobre o valor principal.</p>
                <div class="bg-slate-50 border border-slate-200 rounded p-4 my-4 text-center">
                    <span class="font-serif font-bold text-audit-blue text-lg">J = C × i × t</span>
                </div>
            </div>
        </div>
    </aside>

    <script>
        // Renomeado para evitar colisões globais e erros genéricos de script
        const AuditCalculadora = {
            init() {
                try {
                    if (window.lucide && typeof lucide.createIcons === 'function') {
                        lucide.createIcons();
                    }
                    this.bindEvents();
                    const printDateElem = document.getElementById('print-date');
                    if (printDateElem) {
                        printDateElem.textContent = new Date().toLocaleDateString();
                    }
                } catch (e) {
                    console.error("Erro na inicialização:", e);
                }
            },

            bindEvents() {
                const form = document.getElementById('form-calculadora');
                if (form) {
                    form.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.calculate();
                    });
                }

                const btnLimpar = document.getElementById('btn-limpar');
                if (btnLimpar) {
                    btnLimpar.addEventListener('click', () => {
                        this.setLoading('btn-limpar', true);
                        setTimeout(() => {
                            if (form) form.reset();
                            const resBox = document.getElementById('box-resultado');
                            if (resBox) resBox.classList.add('hidden');
                            this.setLoading('btn-limpar', false);
                        }, 400);
                    });
                }
            },

            setLoading(btnId, isLoading) {
                const btn = document.getElementById(btnId);
                if (!btn) return;
                if (isLoading) {
                    btn.classList.add('btn-loading', 'opacity-80', 'cursor-not-allowed');
                    btn.disabled = true;
                } else {
                    btn.classList.remove('btn-loading', 'opacity-80', 'cursor-not-allowed');
                    btn.disabled = false;
                }
            },

            formatCurrency(input) {
                let value = input.value.replace(/\D/g, "");
                value = (Number(value) / 100).toLocaleString("pt-BR", { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                input.value = value;
            },

            parseCurrency(str) {
                if (!str) return 0;
                return parseFloat(str.replace(/\./g, "").replace(",", ".")) || 0;
            },

            calculate() {
                this.setLoading('btn-calcular', true);

                setTimeout(() => {
                    try {
                        const principalInput = document.getElementById('principal');
                        const taxaInput = document.getElementById('taxa');
                        const periodoInput = document.getElementById('periodo');

                        if (!principalInput || !taxaInput || !periodoInput) return;

                        const P = this.parseCurrency(principalInput.value);
                        const i_val = parseFloat(taxaInput.value);
                        const n_val = parseFloat(periodoInput.value);

                        if (isNaN(P) || isNaN(i_val) || isNaN(n_val)) {
                            this.setLoading('btn-calcular', false);
                            return;
                        }

                        const tipoTaxa = document.getElementById('tipo-taxa').value;
                        const tipoPeriodo = document.getElementById('tipo-periodo').value;

                        let taxaMensal = i_val;
                        if (tipoTaxa === 'anual') taxaMensal = i_val / 12;

                        let meses = n_val;
                        if (tipoPeriodo === 'anos') meses = n_val * 12;

                        const juros = P * (taxaMensal / 100) * meses;
                        const montante = P + juros;
                        const taxaEfetiva = P !== 0 ? (juros / P) * 100 : 0;

                        document.getElementById('res-montante').textContent = montante.toLocaleString('pt-BR', {style:'currency', currency:'BRL'});
                        document.getElementById('res-juros').textContent = juros.toLocaleString('pt-BR', {style:'currency', currency:'BRL'});
                        document.getElementById('res-taxa-efetiva').textContent = taxaEfetiva.toFixed(2) + '%';

                        const box = document.getElementById('box-resultado');
                        if (box) {
                            box.classList.remove('hidden');
                            if (window.innerWidth < 1024) {
                                box.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }
                        }
                    } catch (e) {
                        console.error("Erro no cálculo:", e);
                    } finally {
                        this.setLoading('btn-calcular', false);
                    }
                }, 600);
            },

            async copyResult() {
                this.setLoading('btn-copiar', true);
                const montante = document.getElementById('res-montante').textContent;
                const juros = document.getElementById('res-juros').textContent;
                const text = `AUDIT EDUCA - Juros Simples\nMontante: ${montante}\nJuros: ${juros}`;

                try {
                    // Tenta API moderna
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        await navigator.clipboard.writeText(text);
                        alert("Copiado!");
                    } else {
                        throw new Error("Clipboard API indisponível");
                    }
                } catch (err) {
                    // Fallback manual para evitar Script Error em ambientes restritos
                    try {
                        const textArea = document.createElement("textarea");
                        textArea.value = text;
                        textArea.style.position = "fixed";
                        textArea.style.left = "-9999px";
                        textArea.style.top = "0";
                        document.body.appendChild(textArea);
                        textArea.focus();
                        textArea.select();
                        const successful = document.execCommand('copy');
                        document.body.removeChild(textArea);
                        if (successful) alert("Copiado!");
                        else alert("Falha ao copiar.");
                    } catch (f) {
                        console.error("Falha no fallback de cópia:", f);
                    }
                } finally {
                    this.setLoading('btn-copiar', false);
                }
            },

            generatePDF() {
                this.setLoading('btn-pdf', true);
                setTimeout(() => {
                    window.print();
                    this.setLoading('btn-pdf', false);
                }, 800);
            },

            toggleDrawer(id) {
                const drawer = document.getElementById(`drawer-${id}`);
                const overlay = document.getElementById('drawer-overlay');
                if (drawer && overlay) {
                    drawer.classList.add('open');
                    overlay.classList.add('open');
                    document.body.style.overflow = 'hidden';
                }
            },

            closeDrawers() {
                document.querySelectorAll('.right-drawer').forEach(d => d.classList.remove('open'));
                const overlay = document.getElementById('drawer-overlay');
                if (overlay) overlay.classList.remove('open');
                document.body.style.overflow = '';
            },

            startTour() {
                if (window.driver && window.driver.js && typeof window.driver.js.driver === 'function') {
                    const driverObj = window.driver.js.driver({
                        showProgress: true,
                        steps: [
                            { element: '#calc-card', popover: { title: 'Parâmetros', description: 'Insira Capital, Taxa e Período aqui.' } },
                            { element: '#btn-calcular', popover: { title: 'Calcular', description: 'Clique para processar a simulação.' } }
                        ]
                    });
                    driverObj.drive();
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => AuditCalculadora.init());
    </script>
</body>
</html>