<!DOCTYPE html>
<html lang="pt-br" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cota√ß√£o de Moedas | AuditEduca</title>

    <!-- Meta Tags -->
    <meta name="description" content="Consulte cota√ß√µes de moedas em tempo real com dados oficiais do Banco Central do Brasil (PTAX).">
    <link rel="icon" type="image/webp" href="assets/images/audit-educa-favicon.webp">

    <!-- CSS Externos Globais -->
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/global.css">
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/main.css">
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/header.css">
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/footer.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Tailwind Configurado -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Poppins', 'sans-serif'],
                    },
                    colors: {
                        'audit-gold': '#D4AF37',
                        'audit-navy': '#1E3A8A',
                        'audit-blue': '#3B82F6',
                        'audit-bgDark': '#0F172A',
                        'slate-900': '#0f172a',
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }

        .hero-gradient {
            background: linear-gradient(135deg, #1E3A8A 0%, #0F172A 100%);
        }

        .card-currency {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #e2e8f0;
        }

        .card-currency:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border-color: #D4AF37;
        }

        .filter-btn { 
            transition: all 0.2s ease; 
            border: 1px solid #e2e8f0;
        }
        
        .filter-btn.active {
            background-color: #D4AF37;
            color: white;
            border-color: #D4AF37;
            font-weight: 600;
        }

        .currency-badge {
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 4px 10px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .skeleton-loader {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

        .pulse-dot {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .currency-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- HEADER MODULAR -->
    <div id="header-container" class="no-print sticky top-0 z-50 bg-white">
        <div class="h-20 w-full flex items-center justify-between px-8 border-b border-gray-100">
            <div class="h-8 w-32 skeleton-loader rounded"></div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="flex-grow">
        <!-- Hero Section -->
        <section class="hero-gradient text-white py-20 px-4 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
                <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                            <path d="M 40 0 L 0 0 0 40" fill="none" stroke="white" stroke-width="1"/>
                        </pattern>
                    </defs>
                    <rect width="100%" height="100%" fill="url(#grid)" />
                </svg>
            </div>

            <div class="max-w-5xl mx-auto text-center relative z-10">
                <span class="inline-block py-1 px-3 rounded bg-audit-gold/20 border border-audit-gold/50 text-audit-gold text-xs font-bold mb-4 tracking-wider uppercase">Banco Central do Brasil</span>
                <h1 class="text-4xl md:text-6xl font-black mb-6 tracking-tight">Cota√ß√£o de <span class="text-audit-gold">Moedas</span></h1>
                <p class="text-lg md:text-xl text-slate-300 max-w-2xl mx-auto font-light leading-relaxed">
                    Consulte cota√ß√µes oficiais PTAX atualizadas para convers√µes de moedas estrangeiras.
                </p>

                <!-- Data e Status -->
                <div class="mt-8 flex flex-wrap justify-center items-center gap-6">
                    <div class="flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full">
                        <span class="w-2 h-2 bg-green-400 rounded-full pulse-dot"></span>
                        <span class="text-sm text-slate-300">Dados oficiais BCB</span>
                    </div>
                    <div class="flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full">
                        <i data-lucide="calendar" class="w-4 h-4 text-audit-gold"></i>
                        <span class="text-sm text-slate-300" id="data-referencia">Sincronizando...</span>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="mt-12 max-w-2xl mx-auto relative group">
                    <input type="text" id="search-input" placeholder="Pesquisar moeda (Ex: D√≥lar, Euro, Libra...)"
                           class="w-full bg-white text-slate-900 rounded-2xl py-5 px-14 shadow-2xl focus:ring-4 focus:ring-audit-gold/30 outline-none transition-all placeholder-gray-400">
                    <i data-lucide="search" class="absolute left-5 top-1/2 -translate-y-1/2 text-slate-400 w-6 h-6 group-focus-within:text-audit-gold transition-colors"></i>
                    <button id="btn-buscar" class="absolute right-3 top-1/2 -translate-y-1/2 bg-audit-gold hover:bg-yellow-600 text-audit-navy px-6 py-2.5 rounded-xl font-bold transition shadow-lg">
                        Buscar
                    </button>
                </div>
            </div>
        </section>

        <!-- Content Area -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="flex flex-col lg:flex-row gap-12">
                <!-- Sidebar Filtros -->
                <aside class="lg:col-span-3 w-full lg:w-64 flex-shrink-0">
                    <div class="sticky top-32 space-y-8">
                        <div>
                            <h3 class="text-slate-900 font-bold mb-4 flex items-center gap-2">
                                <i data-lucide="filter" class="w-4 h-4 text-audit-gold"></i> Filtros
                            </h3>
                            <div class="flex flex-col gap-2" id="filter-container">
                                <button class="filter-btn active text-left px-4 py-2 rounded-lg text-sm font-medium transition" data-filter="all">Todas as Moedas</button>
                                <button class="filter-btn text-left px-4 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-audit-navy transition" data-filter="principais">Principais</button>
                                <button class="filter-btn text-left px-4 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-audit-navy transition" data-filter="americas">Am√©ricas</button>
                                <button class="filter-btn text-left px-4 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-audit-navy transition" data-filter="europa">Europa</button>
                                <button class="filter-btn text-left px-4 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-audit-navy transition" data-filter="asia">√Åsia/Oceania</button>
                                <button class="filter-btn text-left px-4 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-audit-navy transition" data-filter="africa">√Åfrica</button>
                                <button class="filter-btn text-left px-4 py-2 rounded-lg text-sm font-medium text-slate-600 hover:text-audit-navy transition" data-filter="outros">Outras Regi√µes</button>
                            </div>
                        </div>

                        <!-- Conversor R√°pido -->
                        <div class="p-6 bg-white rounded-2xl border border-gray-100 shadow-sm">
                            <h4 class="font-bold text-slate-900 mb-4 flex items-center gap-2">
                                <i data-lucide="calculator" class="w-4 h-4 text-audit-gold"></i> Conversor R√°pido
                            </h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Valor em BRL</label>
                                    <input type="number" id="valor-brl" value="1000" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-audit-gold/30 outline-none">
                                </div>
                                <div>
                                    <label class="text-xs text-slate-500 mb-1 block">Moeda destino</label>
                                    <select id="moeda-destino" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-audit-gold/30 outline-none">
                                        <!-- Preenchido via JS -->
                                    </select>
                                </div>
                                <div class="pt-4 border-t border-gray-100">
                                    <p class="text-xs text-slate-500">Resultado:</p>
                                    <p class="text-2xl font-bold text-audit-navy" id="resultado-conversao">--</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- Grid de Resultados -->
                <div class="flex-1">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-10 gap-4">
                        <h2 class="text-2xl font-bold text-slate-900">Cota√ß√µes <span class="text-audit-gold" id="contador-moedas">--</span></h2>
                        <div class="flex items-center gap-4">
                            <button id="btn-atualizar" class="flex items-center gap-2 text-sm text-audit-navy bg-white px-4 py-2 rounded-lg border border-gray-200 hover:border-audit-gold transition shadow-sm">
                                <i data-lucide="refresh-cw" class="w-4 h-4"></i> Atualizar
                            </button>
                            <div class="flex items-center gap-2 text-sm text-slate-500 bg-white px-3 py-2 rounded-lg border border-gray-100 shadow-sm">
                                <span>Ordenar:</span>
                                <select id="ordenar" class="bg-transparent font-bold text-audit-navy outline-none cursor-pointer">
                                    <option value="nome">Nome A-Z</option>
                                    <option value="cotacao-asc">Menor cota√ß√£o</option>
                                    <option value="cotacao-desc">Maior cota√ß√£o</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="loading-state" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
                        <div class="bg-white rounded-2xl p-6 border border-gray-100">
                            <div class="flex items-center gap-4 mb-4"><div class="w-14 h-14 rounded-full skeleton-loader"></div><div class="flex-1"><div class="h-5 w-24 skeleton-loader rounded mb-2"></div><div class="h-4 w-16 skeleton-loader rounded"></div></div></div>
                            <div class="h-8 w-32 skeleton-loader rounded mb-2"></div><div class="h-4 w-full skeleton-loader rounded"></div>
                        </div>
                    </div>

                    <!-- Grid de Moedas -->
                    <div id="moedas-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 hidden"></div>

                    <!-- Empty State -->
                    <div id="empty-state" class="hidden text-center py-16">
                        <i data-lucide="search-x" class="w-16 h-16 text-slate-300 mx-auto mb-4"></i>
                        <h3 class="text-xl font-bold text-slate-700 mb-2">Nenhuma moeda encontrada nesta categoria</h3>
                    </div>

                    <!-- Erro State -->
                    <div id="error-state" class="hidden text-center py-16">
                        <i data-lucide="alert-triangle" class="w-16 h-16 text-red-400 mx-auto mb-4"></i>
                        <h3 class="text-xl font-bold text-slate-700 mb-2">Erro ao carregar dados</h3>
                        <p class="text-slate-500 mb-4">Servi√ßo do Banco Central temporariamente indispon√≠vel.</p>
                        <button id="btn-retry" class="bg-audit-gold text-audit-navy px-6 py-2 rounded-lg font-bold hover:bg-yellow-600 transition">Tentar Novamente</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- FOOTER MODULAR -->
    <div id="footer-container" class="no-print mt-auto"></div>

    <script>
        const RESOURCES = {
            headerHTML: 'https://auditeduca.com.br/assets/components/header.html',
            footerHTML: 'https://auditeduca.com.br/assets/components/footer.html',
            scripts: [
                'https://auditeduca.com.br/assets/js/utils.js',
                'https://auditeduca.com.br/assets/js/console-cleaner.js'
            ]
        };

        // Mapeamento Completo Consolidado para Filtros
        const MOEDAS_CONFIG = {
            "USD": { "nome": "D√≥lar Americano", "bandeira": "üá∫üá∏", "cor": "bg-emerald-600", "regiao": "americas", "principal": true },
            "EUR": { "nome": "Euro", "bandeira": "üá™üá∫", "cor": "bg-blue-700", "regiao": "europa", "principal": true },
            "GBP": { "nome": "Libra Esterlina", "bandeira": "üá¨üáß", "cor": "bg-indigo-800", "regiao": "europa", "principal": true },
            "JPY": { "nome": "Iene Japon√™s", "bandeira": "üáØüáµ", "cor": "bg-rose-600", "regiao": "asia", "principal": true },
            "CHF": { "nome": "Franco Su√≠√ßo", "bandeira": "üá®üá≠", "cor": "bg-red-500", "regiao": "europa", "principal": true },
            "AUD": { "nome": "D√≥lar Australiano", "bandeira": "üá¶üá∫", "cor": "bg-blue-800", "regiao": "asia", "principal": false },
            "CAD": { "nome": "D√≥lar Canadense", "bandeira": "üá®üá¶", "cor": "bg-red-600", "regiao": "americas", "principal": false },
            "CNY": { "nome": "Yuan Chin√™s", "bandeira": "üá®üá≥", "cor": "bg-red-600", "regiao": "asia", "principal": true },
            "ARS": { "nome": "Peso Argentino", "bandeira": "üá¶üá∑", "cor": "bg-sky-400", "regiao": "americas", "principal": false },
            "DKK": { "nome": "Coroa Dinamarquesa", "bandeira": "üá©üá∞", "cor": "bg-red-700", "regiao": "europa", "principal": false },
            "NOK": { "nome": "Coroa Norueguesa", "bandeira": "üá≥üá¥", "cor": "bg-blue-900", "regiao": "europa", "principal": false },
            "SEK": { "nome": "Coroa Sueca", "bandeira": "üá∏üá™", "cor": "bg-blue-500", "regiao": "europa", "principal": false },
            "RUB": { "nome": "Rublo Russo", "bandeira": "üá∑üá∫", "cor": "bg-slate-500", "regiao": "europa", "principal": false },
            "MXN": { "nome": "Peso Mexicano", "bandeira": "üá≤üáΩ", "cor": "bg-green-800", "regiao": "americas", "principal": false },
            "SGD": { "nome": "D√≥lar de Singapura", "bandeira": "üá∏üá¨", "cor": "bg-red-500", "regiao": "asia", "principal": false },
            "HKD": { "nome": "D√≥lar de Hong Kong", "bandeira": "üá≠üá∞", "cor": "bg-red-600", "regiao": "asia", "principal": false },
            "KRW": { "nome": "Won Sul-Coreano", "bandeira": "üá∞üá∑", "cor": "bg-slate-700", "regiao": "asia", "principal": false },
            "INR": { "nome": "R√∫pia Indiana", "bandeira": "üáÆüá≥", "cor": "bg-orange-500", "regiao": "asia", "principal": false },
            "NZD": { "nome": "D√≥lar Neozeland√™s", "bandeira": "üá≥üáø", "cor": "bg-blue-900", "regiao": "asia", "principal": false },
            "ZAR": { "nome": "Rand Sul-Africano", "bandeira": "üáøüá¶", "cor": "bg-green-700", "regiao": "africa", "principal": false },
            "CLP": { "nome": "Peso Chileno", "bandeira": "üá®üá±", "cor": "bg-red-800", "regiao": "americas", "principal": false },
            "COP": { "nome": "Peso Colombiano", "bandeira": "üá®üá¥", "cor": "bg-yellow-500", "regiao": "americas", "principal": false },
            "PEN": { "nome": "Sol Peruano", "bandeira": "üáµüá™", "cor": "bg-red-700", "regiao": "americas", "principal": false },
            "UYU": { "nome": "Peso Uruguaio", "bandeira": "üá∫üáæ", "cor": "bg-sky-600", "regiao": "americas", "principal": false },
            "PYG": { "nome": "Guarani Paraguaio", "bandeira": "üáµüáæ", "cor": "bg-red-500", "regiao": "americas", "principal": false },
            "BOB": { "nome": "Boliviano", "bandeira": "üáßüá¥", "cor": "bg-green-600", "regiao": "americas", "principal": false },
            "ILS": { "nome": "Novo Shekel Israelense", "bandeira": "üáÆüá±", "cor": "bg-blue-600", "regiao": "asia", "principal": false },
            "SAR": { "nome": "Riyal Saudita", "bandeira": "üá∏üá¶", "cor": "bg-green-700", "regiao": "asia", "principal": false },
            "AED": { "nome": "Dirham dos EAU", "bandeira": "üá¶üá™", "cor": "bg-slate-600", "regiao": "asia", "principal": false },
            "TRY": { "nome": "Lira Turca", "bandeira": "üáπüá∑", "cor": "bg-red-700", "regiao": "europa", "principal": false },
            "PLN": { "nome": "Zloty Polon√™s", "bandeira": "üáµüá±", "cor": "bg-red-500", "regiao": "europa", "principal": false },
            "HUF": { "nome": "Florim H√∫ngaro", "bandeira": "üá≠üá∫", "cor": "bg-green-600", "regiao": "europa", "principal": false },
            "CZK": { "nome": "Coroa Checa", "bandeira": "üá®üáø", "cor": "bg-blue-700", "regiao": "europa", "principal": false },
            "THB": { "nome": "Baht Tailand√™s", "bandeira": "üáπüá≠", "cor": "bg-indigo-500", "regiao": "asia", "principal": false },
            "IDR": { "nome": "Rupia Indon√©sia", "bandeira": "üáÆüá©", "cor": "bg-red-500", "regiao": "asia", "principal": false },
            "MYR": { "nome": "Ringgit Malaio", "bandeira": "üá≤üáæ", "cor": "bg-yellow-600", "regiao": "asia", "principal": false },
            "PHP": { "nome": "Peso Filipino", "bandeira": "üáµüá≠", "cor": "bg-blue-500", "regiao": "asia", "principal": false },
            "BHD": { "nome": "Dinar Bareinita", "bandeira": "üáßüá≠", "cor": "bg-red-600", "regiao": "asia", "principal": false },
            "KWD": { "nome": "Dinar Kuwaitiano", "bandeira": "üá∞üáº", "cor": "bg-blue-400", "regiao": "asia", "principal": false },
            "QAR": { "nome": "Riyal Catariano", "bandeira": "üá∂üá¶", "cor": "bg-purple-800", "regiao": "asia", "principal": false },
            "OMR": { "nome": "Riyal Omanense", "bandeira": "üá¥üá≤", "cor": "bg-red-700", "regiao": "asia", "principal": false },
            "JOD": { "nome": "Dinar Jordaniano", "bandeira": "üáØüá¥", "cor": "bg-slate-500", "regiao": "asia", "principal": false },
            "EGP": { "nome": "Libra Eg√≠pcia", "bandeira": "üá™üá¨", "cor": "bg-slate-800", "regiao": "africa", "principal": false },
            "DZD": { "nome": "Dinar Argelino", "bandeira": "üá©üáø", "cor": "bg-green-800", "regiao": "africa", "principal": false },
            "MAD": { "nome": "Dirham Marroquino", "bandeira": "üá≤üá¶", "cor": "bg-red-600", "regiao": "africa", "principal": false },
            "CRC": { "nome": "Col√≥n Costarriquenho", "bandeira": "üá®üá∑", "cor": "bg-blue-600", "regiao": "americas", "principal": false },
            "TWD": { "nome": "Novo D√≥lar Taiwan√™s", "bandeira": "üáπüáº", "cor": "bg-blue-500", "regiao": "asia", "principal": false },
            "RON": { "nome": "Leu Romeno", "bandeira": "üá∑üá¥", "cor": "bg-yellow-500", "regiao": "europa", "principal": false },
            "BGN": { "nome": "Lev B√∫lgaro", "bandeira": "üáßüá¨", "cor": "bg-green-600", "regiao": "europa", "principal": false },
            "ISK": { "nome": "Coroa Islandesa", "bandeira": "üáÆüá∏", "cor": "bg-blue-800", "regiao": "europa", "principal": false },
            "VES": { "nome": "Bol√≠var Soberano", "bandeira": "üáªüá™", "cor": "bg-yellow-700", "regiao": "americas", "principal": false },
            "VND": { "nome": "Dong Vietnamita", "bandeira": "üáªüá≥", "cor": "bg-rose-700", "regiao": "asia", "principal": false },
            "TJS": { "nome": "Somoni do Tajiquist√£o", "bandeira": "üáπüáØ", "cor": "bg-green-500", "regiao": "asia", "principal": false },
            "TMT": { "nome": "Manat Turcomeno", "bandeira": "üáπüá≤", "cor": "bg-green-900", "regiao": "asia", "principal": false },
            "UZS": { "nome": "Som Uzbeque", "bandeira": "üá∫üáø", "cor": "bg-blue-400", "regiao": "asia", "principal": false },
            "PKR": { "nome": "R√∫pia Paquistanesa", "bandeira": "üáµüá∞", "cor": "bg-green-600", "regiao": "asia", "principal": false },
            "LKR": { "nome": "R√∫pia do Sri Lanka", "bandeira": "üá±üá∞", "cor": "bg-red-800", "regiao": "asia", "principal": false },
            "KES": { "nome": "Xelim Queniano", "bandeira": "üá∞üá™", "cor": "bg-red-700", "regiao": "africa", "principal": false },
            "NGN": { "nome": "Naira Nigeriana", "bandeira": "üá≥üá¨", "cor": "bg-green-500", "regiao": "africa", "principal": false },
            "TND": { "nome": "Dinar Tunisiano", "bandeira": "üáπüá≥", "cor": "bg-red-500", "regiao": "africa", "principal": false },
            "GEL": { "nome": "Lari Georgiano", "bandeira": "üá¨üá™", "cor": "bg-red-600", "regiao": "asia", "principal": false },
            "AZN": { "nome": "Manat Azerbaijano", "bandeira": "üá¶üáø", "cor": "bg-blue-500", "regiao": "asia", "principal": false },
            "BYN": { "nome": "Rublo Bielorrusso", "bandeira": "üáßüáæ", "cor": "bg-red-500", "regiao": "europa", "principal": false },
            "KZT": { "nome": "Tenge Cazaque", "bandeira": "üá∞üáø", "cor": "bg-blue-600", "regiao": "asia", "principal": false },
            "MDL": { "nome": "Leu Moldavo", "bandeira": "üá≤üá©", "cor": "bg-blue-700", "regiao": "europa", "principal": false },
            "KGS": { "nome": "Som Quirguiz", "bandeira": "üá∞üá¨", "cor": "bg-red-500", "regiao": "asia", "principal": false },
            "DOP": { "nome": "Peso Dominicano", "bandeira": "üá©üá¥", "cor": "bg-blue-500", "regiao": "americas", "principal": false },
            "GTQ": { "nome": "Quetzal de Guatemala", "bandeira": "üá¨üáπ", "cor": "bg-green-600", "regiao": "americas", "principal": false },
            "HNL": { "nome": "Lempira de Honduras", "bandeira": "üá≠üá≥", "cor": "bg-blue-800", "regiao": "americas", "principal": false },
            "NIO": { "nome": "C√≥rdoba de Nicar√°gua", "bandeira": "üá≥üáÆ", "cor": "bg-blue-500", "regiao": "americas", "principal": false },
            "PAB": { "nome": "Balboa de Panam√°", "bandeira": "üáµüá¶", "cor": "bg-blue-600", "regiao": "americas", "principal": false },
            "BZD": { "nome": "D√≥lar de Belize", "bandeira": "üáßüáø", "cor": "bg-green-700", "regiao": "americas", "principal": false },
            "GHS": { "nome": "Cedi de Gana", "bandeira": "üá¨üá≠", "cor": "bg-yellow-500", "regiao": "africa", "principal": false },
            "MUR": { "nome": "R√∫pia Mauriciana", "bandeira": "üá≤üá∫", "cor": "bg-red-600", "regiao": "africa", "principal": false },
            "ETB": { "nome": "Birr Et√≠ope", "bandeira": "üá™üáπ", "cor": "bg-green-700", "regiao": "africa", "principal": false }
        };

        let moedasData = [];
        let filtroAtual = 'all';
        let searchTerm = '';

        function formatBCBDate(date) {
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            const y = date.getFullYear();
            return `${m}-${d}-${y}`;
        }

        async function buscarCotacoes() {
            showLoading();
            try {
                const hoje = new Date();
                const haUmaSemana = new Date();
                haUmaSemana.setDate(hoje.getDate() - 7);

                const dataFinal = formatBCBDate(hoje);
                const dataInicial = formatBCBDate(haUmaSemana);

                const resMoedas = await fetch(`https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/Moedas?$format=json`);
                const listaMoedas = await resMoedas.json();

                const promessas = listaMoedas.value.map(async (m) => {
                    try {
                        const url = `https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/CotacaoMoedaPeriodo(moeda=@moeda,dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?@moeda='${m.simbolo}'&@dataInicial='${dataInicial}'&@dataFinalCotacao='${dataFinal}'&$top=1&$orderby=dataHoraCotacao%20desc&$format=json`;
                        
                        const res = await fetch(url);
                        if (!res.ok) return null;
                        const data = await res.json();

                        if (data.value && data.value.length > 0) {
                            const c = data.value[0];
                            // Busca config no mapeamento. Se n√£o existir, marca como 'outros'
                            const config = MOEDAS_CONFIG[m.simbolo] || { 
                                nome: m.nomeFormatado, 
                                bandeira: 'üåç', 
                                cor: 'bg-gray-400', 
                                regiao: 'outros', 
                                principal: false 
                            };
                            return {
                                codigo: m.simbolo,
                                nome: config.nome,
                                bandeira: config.bandeira,
                                cor: config.cor,
                                regiao: config.regiao,
                                principal: config.principal,
                                cotacaoCompra: c.cotacaoCompra,
                                cotacaoVenda: c.cotacaoVenda,
                                dataHoraCotacao: c.dataHoraCotacao,
                                tipoBoletim: c.tipoBoletim
                            };
                        }
                        return null;
                    } catch { return null; }
                });

                const resultados = await Promise.all(promessas);
                moedasData = resultados.filter(x => x !== null);

                if (moedasData.length > 0) {
                    const dataRef = new Date(moedasData[0].dataHoraCotacao);
                    document.getElementById('data-referencia').textContent = dataRef.toLocaleDateString('pt-BR');
                }

                renderizarMoedas();
                atualizarSelectMoedas();
                atualizarConversor();

            } catch (error) {
                console.error('Erro BCB:', error);
                showError();
            }
        }

        function showLoading() {
            document.getElementById('loading-state').classList.remove('hidden');
            document.getElementById('moedas-grid').classList.add('hidden');
            document.getElementById('error-state').classList.add('hidden');
            document.getElementById('empty-state').classList.add('hidden');
        }

        function showError() {
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('error-state').classList.remove('hidden');
        }

        function renderizarMoedas() {
            let moedas = [...moedasData];

            // Filtro por categoria
            if (filtroAtual !== 'all') {
                if (filtroAtual === 'principais') {
                    moedas = moedas.filter(m => m.principal);
                } else {
                    moedas = moedas.filter(m => m.regiao === filtroAtual);
                }
            }

            // Filtro por texto (Busca)
            if (searchTerm) {
                const term = searchTerm.toLowerCase();
                moedas = moedas.filter(m => 
                    m.nome.toLowerCase().includes(term) || 
                    m.codigo.toLowerCase().includes(term)
                );
            }

            // Ordena√ß√£o
            const ord = document.getElementById('ordenar').value;
            if (ord === 'nome') moedas.sort((a, b) => a.nome.localeCompare(b.nome));
            else if (ord === 'cotacao-asc') moedas.sort((a, b) => a.cotacaoVenda - b.cotacaoVenda);
            else if (ord === 'cotacao-desc') moedas.sort((a, b) => b.cotacaoVenda - a.cotacaoVenda);

            const grid = document.getElementById('moedas-grid');
            const loading = document.getElementById('loading-state');
            const empty = document.getElementById('empty-state');

            loading.classList.add('hidden');
            document.getElementById('contador-moedas').textContent = `${moedas.length} moedas`;

            if (moedas.length === 0) {
                grid.classList.add('hidden');
                empty.classList.remove('hidden');
                return;
            }

            empty.classList.add('hidden');
            grid.classList.remove('hidden');

            grid.innerHTML = moedas.map(m => `
                <div class="card-currency bg-white rounded-2xl overflow-hidden flex flex-col group">
                    <div class="p-6">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="currency-icon ${m.cor} text-white shadow-lg">${m.bandeira}</div>
                            <div class="flex-1">
                                <h3 class="text-lg font-bold text-slate-900 group-hover:text-audit-gold transition-colors">${m.nome}</h3>
                                <span class="text-sm font-mono text-slate-500">${m.codigo}</span>
                            </div>
                            ${m.principal ? '<span class="currency-badge bg-audit-gold text-white">Principal</span>' : ''}
                        </div>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center"><span class="text-sm text-slate-500">Compra:</span><span class="text-lg font-bold text-audit-navy">R$ ${m.cotacaoCompra.toFixed(4).replace('.', ',')}</span></div>
                            <div class="flex justify-between items-center"><span class="text-sm text-slate-500">Venda:</span><span class="text-lg font-bold text-green-600">R$ ${m.cotacaoVenda.toFixed(4).replace('.', ',')}</span></div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-slate-100 flex items-center justify-between text-xs text-slate-400">
                            <span class="flex items-center gap-1"><i data-lucide="clock" class="w-3 h-3"></i> ${new Date(m.dataHoraCotacao).toLocaleTimeString('pt-BR', {hour:'2-digit', minute:'2-digit'})}</span>
                            <span class="px-2 py-1 bg-slate-100 rounded">${m.tipoBoletim}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            if (window.lucide) lucide.createIcons();
        }

        function atualizarConversor() {
            const valorBRL = parseFloat(document.getElementById('valor-brl').value) || 0;
            const moedaDestino = document.getElementById('moeda-destino').value;
            const moeda = moedasData.find(m => m.codigo === moedaDestino);
            const res = document.getElementById('resultado-conversao');
            if (moeda) {
                const valorConvertido = valorBRL / moeda.cotacaoVenda;
                res.textContent = `${moeda.codigo} ${valorConvertido.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            } else {
                res.textContent = '--';
            }
        }

        function atualizarSelectMoedas() {
            const select = document.getElementById('moeda-destino');
            // S√≥ mostra no select moedas que temos mapeadas ou que s√£o relevantes
            const filtradas = moedasData.filter(m => MOEDAS_CONFIG[m.codigo]);
            if (filtradas.length > 0) {
                select.innerHTML = filtradas
                    .sort((a, b) => a.nome.localeCompare(b.nome))
                    .map(m => `<option value="${m.codigo}" ${m.codigo === 'USD' ? 'selected' : ''}>${m.nome} (${m.codigo})</option>`).join('');
            }
        }

        async function initPage() {
            // Carregar Componentes Globais
            fetch(RESOURCES.headerHTML).then(r => r.text()).then(html => document.getElementById('header-container').innerHTML = html).catch(() => {});
            fetch(RESOURCES.footerHTML).then(r => r.text()).then(html => document.getElementById('footer-container').innerHTML = html).catch(() => {});

            if (window.lucide) lucide.createIcons();
            
            await buscarCotacoes();

            // Configura√ß√£o dos Bot√µes de Filtro
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    // Limpa estados de todos os bot√µes
                    document.querySelectorAll('.filter-btn').forEach(b => {
                        b.classList.remove('active');
                        b.classList.add('text-slate-600', 'hover:text-audit-navy');
                    });
                    
                    // Ativa bot√£o clicado
                    btn.classList.add('active');
                    btn.classList.remove('text-slate-600', 'hover:text-audit-navy');

                    filtroAtual = btn.dataset.filter;
                    renderizarMoedas();
                });
            });

            // Busca
            document.getElementById('search-input').addEventListener('input', (e) => {
                searchTerm = e.target.value;
                renderizarMoedas();
            });

            document.getElementById('btn-buscar').addEventListener('click', () => {
                searchTerm = document.getElementById('search-input').value;
                renderizarMoedas();
            });

            // Ordena√ß√£o
            document.getElementById('ordenar').addEventListener('change', renderizarMoedas);

            // Atualizar
            document.getElementById('btn-atualizar').addEventListener('click', buscarCotacoes);
            document.getElementById('btn-retry')?.addEventListener('click', buscarCotacoes);

            // Conversor
            document.getElementById('valor-brl').addEventListener('input', atualizarConversor);
            document.getElementById('moeda-destino').addEventListener('change', atualizarConversor);
        }

        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>