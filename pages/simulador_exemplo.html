<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulado CFC | AuditEduca</title>
    
    <!-- Ícone -->
    <link rel="icon" href="https://auditeduca.com.br/assets/images/audit-educa-favicon.webp">

    <!-- Fontes e Ícones -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- CSS Globais AuditEduca -->
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/global.css">
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/main.css">
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/header.css">
    <link rel="stylesheet" href="https://auditeduca.com.br/assets/css/footer.css">

    <!-- Tailwind Configurado -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        'audit-gold': '#D4AF37',
                        'audit-gold-light': '#F3E5AB',
                        'audit-navy': '#1E3A8A',
                        'audit-blue': '#3B82F6',
                        'audit-dark': '#0F172A',
                        'slate-900': '#0f172a',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f8fafc; display: flex; flex-direction: column; min-height: 100vh; }
        
        .hero-gradient {
            background: linear-gradient(135deg, #1E3A8A 0%, #0F172A 100%);
        }

        /* Estilização dos Radios */
        .option-radio:checked + div {
            border-color: #D4AF37;
            background-color: #FEFCE8;
        }
        .option-radio:checked + div .radio-circle {
            background-color: #D4AF37;
            border-color: #D4AF37;
            color: #1E3A8A;
        }

        /* Scrollbar Personalizada */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Sidebar Items */
        .sidebar-btn.active {
            background-color: #1E3A8A;
            color: #D4AF37;
            border-color: #1E3A8A;
            font-weight: 700;
        }
        .sidebar-btn.answered {
            background-color: #EFF6FF;
            color: #1E3A8A;
            border-color: #BFDBFE;
        }
        
        /* Cards de Biblioteca (Estilo AuditEduca) */
        .card-library {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #e2e8f0;
        }
        .card-library:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: #D4AF37;
        }

        /* Skeleton Loading Styles */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

        @media print {
            .no-print { display: none !important; }
            #content-area { overflow: visible !important; height: auto !important; }
            .print-visible { display: block !important; }
        }
    </style>
</head>
<body class="text-slate-700 font-sans">

    <!-- HEADER MODULAR (Carregado via JS) -->
    <div id="header-container" class="sticky top-0 z-50 bg-white border-b border-gray-100 no-print shadow-sm min-h-[80px]">
        <div class="h-20 w-full flex items-center justify-between px-8">
            <div class="h-8 w-32 skeleton rounded"></div>
        </div>
    </div>

    <!-- BARRA DE FERRAMENTAS DO EXAME (Aparece abaixo do header oficial) -->
    <div id="exam-toolbar" class="hidden sticky top-[80px] z-40 bg-white/95 backdrop-blur-sm border-b border-gray-200 shadow-sm py-2 px-4 no-print animate-slide-up">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <span class="text-xs font-bold text-audit-navy uppercase tracking-wider hidden md:block">Simulador em Andamento</span>
                <div class="flex items-center gap-2 bg-slate-100 px-3 py-1.5 rounded-lg border border-slate-200">
                    <i data-lucide="clock" class="w-4 h-4 text-audit-gold"></i>
                    <span id="timer" class="font-mono font-bold text-audit-navy text-sm">00:00:00</span>
                </div>
            </div>
            
            <div class="flex items-center gap-3">
                <button onclick="toggleSound()" id="btn-sound" class="p-2 rounded-full hover:bg-gray-100 text-gray-400 hover:text-audit-navy transition-colors" title="Sons">
                    <i class="fa-solid fa-volume-high"></i>
                </button>
                <button onclick="exportOptions()" class="hidden md:flex items-center gap-2 text-xs font-bold text-slate-600 hover:text-audit-navy bg-white border border-gray-200 px-3 py-1.5 rounded-lg hover:border-audit-navy transition-all">
                    <i data-lucide="printer" class="w-3 h-3"></i> Imprimir
                </button>
            </div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="flex-grow flex flex-col relative">
        
        <!-- SIDEBAR (Navegação) -->
        <aside id="exam-sidebar" class="hidden fixed top-[130px] left-0 bottom-0 w-72 bg-white border-r border-gray-100 z-30 no-print flex-col transition-transform transform -translate-x-full lg:translate-x-0 lg:hidden shadow-xl lg:shadow-none h-[calc(100vh-130px)]">
            <div class="p-6 border-b border-gray-50 bg-slate-50/50">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-xs font-bold text-slate-400 uppercase tracking-wider">Mapa da Prova</h2>
                    <button onclick="toggleSidebar()" class="lg:hidden text-slate-400 hover:text-audit-navy"><i class="fa-solid fa-times"></i></button>
                </div>
                <div class="flex gap-4 text-[10px] font-medium text-slate-500">
                    <div class="flex items-center gap-1"><div class="w-2 h-2 rounded-full bg-audit-navy"></div> Atual</div>
                    <div class="flex items-center gap-1"><div class="w-2 h-2 rounded-full bg-blue-100 border border-blue-200"></div> Feito</div>
                </div>
            </div>
            
            <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                <div id="question-map" class="grid grid-cols-4 gap-2">
                    <!-- Gerado via JS -->
                </div>
            </div>

            <div class="p-4 border-t border-gray-50 bg-slate-50">
                <button onclick="finishExam()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg shadow-green-200 transition-all flex items-center justify-center gap-2 text-sm">
                    <i class="fa-solid fa-check-circle"></i> <span>Entregar Prova</span>
                </button>
            </div>
        </aside>

        <!-- AREA CENTRAL (Conteúdo Centralizado) -->
        <div id="main-content" class="flex-1 overflow-y-auto bg-slate-50/50 scroll-smooth w-full flex flex-col items-center">
            
            <!-- VIEW 1: LANDING PAGE (Boas Vindas) -->
            <section id="view-home" class="w-full min-h-[calc(100vh-80px)] flex flex-col items-center justify-center animate-fade-in relative">
                <!-- Hero Background -->
                <div class="absolute inset-0 hero-gradient overflow-hidden">
                     <div class="absolute inset-0 opacity-10" style="background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'none\' fill-rule=\'evenodd\'%3E%3Cg fill=\'%23ffffff\' fill-opacity=\'1\'%3E%3Cpath d=\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
                </div>

                <div class="relative z-10 w-full max-w-4xl px-6 text-center text-white py-12 flex flex-col items-center">
                    <span class="inline-block py-1 px-3 rounded-full bg-audit-gold/20 border border-audit-gold/40 text-audit-gold text-[10px] font-bold tracking-widest uppercase mb-6">
                        Exame de Suficiência 2025.2
                    </span>
                    <h1 class="text-4xl md:text-6xl font-display font-bold mb-6 tracking-tight leading-tight">
                        Simulado <span class="text-audit-gold">Interativo</span>
                    </h1>
                    <p class="text-lg md:text-xl text-slate-300 max-w-2xl font-light leading-relaxed mb-10">
                        Acesse o banco de questões atualizado, pratique com tempo controlado e receba feedbacks detalhados para sua aprovação.
                    </p>

                    <!-- Card de Configuração Centralizado -->
                    <div class="bg-white text-slate-800 p-8 rounded-2xl shadow-2xl max-w-md w-full transform hover:scale-[1.02] transition-transform duration-300 border border-slate-200">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-gray-100">
                            <div class="w-10 h-10 rounded-full bg-audit-navy/10 flex items-center justify-center text-audit-navy">
                                <i class="fa-solid fa-sliders"></i>
                            </div>
                            <div class="text-left">
                                <h3 class="font-bold text-audit-navy text-lg">Configurar Sessão</h3>
                                <p class="text-xs text-slate-400">Personalize seu treino de hoje</p>
                            </div>
                        </div>
                        
                        <div class="mb-8 text-left">
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-xs font-bold text-slate-500 uppercase">Quantidade de Questões</label>
                                <span id="q-count-display" class="text-xl font-bold text-audit-gold bg-audit-gold/10 px-3 py-1 rounded-lg">9</span>
                            </div>
                            
                            <input type="range" id="q-range" min="1" max="9" value="9" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-audit-navy hover:accent-audit-gold transition-colors">
                            
                            <div class="flex justify-between text-[10px] text-slate-400 mt-2 font-medium">
                                <span>1 questão</span>
                                <span>9 questões</span>
                            </div>
                        </div>

                        <button onclick="startSetup()" class="w-full bg-audit-navy hover:bg-blue-900 text-white font-bold py-4 rounded-xl shadow-lg transition-all transform hover:-translate-y-1 flex items-center justify-center gap-2 group">
                            Iniciar Simulado <i data-lucide="arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- VIEW 2: EXAM INTERFACE -->
            <section id="view-exam" class="hidden w-full max-w-7xl mx-auto px-4 py-8 lg:py-12 animate-slide-up flex flex-col items-center">
                
                <!-- Navegação Mobile Header -->
                <div class="lg:hidden w-full mb-6 flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100 sticky top-2 z-30">
                    <span class="text-xs font-bold text-slate-500 uppercase">Questão <span id="mobile-q-num" class="text-audit-navy text-lg">1</span></span>
                    <button onclick="toggleSidebar()" class="text-audit-navy hover:text-audit-gold transition-colors flex items-center gap-2 font-bold text-sm">
                        <i class="fa-solid fa-bars"></i> Mapa da Prova
                    </button>
                </div>

                <!-- Card da Questão -->
                <div class="w-full max-w-4xl bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden mb-24 relative">
                    <!-- Header da Questão -->
                    <div class="bg-slate-50 border-b border-gray-100 p-4 md:p-6 flex justify-between items-center">
                        <span id="topic-badge" class="bg-blue-50 text-audit-blue px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border border-blue-100">
                            Carregando...
                        </span>
                        <div class="flex gap-2">
                            <button onclick="readQuestion()" class="w-9 h-9 rounded-full hover:bg-white hover:shadow-md text-slate-400 hover:text-audit-blue transition-all border border-transparent hover:border-gray-100" title="Ouvir Questão">
                                <i class="fa-solid fa-volume-high"></i>
                            </button>
                            <button onclick="toggleBookmark()" id="btn-bookmark" class="w-9 h-9 rounded-full hover:bg-white hover:shadow-md text-slate-400 hover:text-audit-gold transition-all border border-transparent hover:border-gray-100" title="Marcar para Revisão">
                                <i class="fa-regular fa-bookmark"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Corpo da Questão -->
                    <div class="p-6 md:p-10">
                        <div class="flex flex-col md:flex-row gap-6 mb-8">
                            <!-- Número Grande -->
                            <div class="hidden md:flex w-12 h-12 rounded-xl bg-audit-navy text-white items-center justify-center font-display font-bold text-xl shadow-lg shadow-blue-900/20 flex-shrink-0" id="q-number-circle">1</div>
                            
                            <!-- Texto -->
                            <div id="q-text" class="text-lg text-slate-700 leading-relaxed font-medium"></div>
                        </div>

                        <!-- Alternativas -->
                        <div class="space-y-3 pl-0 md:pl-[4.5rem]" id="options-container">
                            <!-- JS -->
                        </div>
                    </div>
                </div>

                <!-- Barra de Navegação Flutuante -->
                <div class="fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-md border border-gray-200 shadow-2xl rounded-full p-2 pl-4 pr-2 flex items-center gap-4 z-50 no-print transition-all hover:scale-105">
                    <button onclick="playSound('click'); prevQuestion()" id="btn-prev" class="w-10 h-10 rounded-full flex items-center justify-center text-slate-400 hover:text-audit-navy hover:bg-slate-100 transition-all disabled:opacity-30">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    
                    <span class="text-xs font-bold text-slate-400 tracking-widest hidden sm:block">NAVEGAÇÃO</span>
                    
                    <button onclick="playSound('click'); nextQuestion()" id="btn-next" class="px-6 h-10 rounded-full bg-audit-navy text-white font-bold text-sm hover:bg-blue-900 shadow-md flex items-center gap-2 transition-transform">
                        Próxima <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>
            </section>

            <!-- VIEW 3: RESULTS & LIBRARY -->
            <section id="view-results" class="hidden w-full max-w-7xl mx-auto px-4 py-12 animate-fade-in pb-24">
                
                <!-- Scorecard -->
                <div class="bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden mb-12">
                    <div class="bg-audit-navy p-10 text-center relative overflow-hidden">
                        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
                        <h2 class="text-3xl font-display font-bold text-white mb-3 relative z-10">Resultado da Avaliação</h2>
                        <p id="motivational-phrase" class="text-audit-gold italic text-sm font-medium relative z-10 opacity-90">"..."</p>
                    </div>
                    
                    <div class="p-8 flex flex-col md:flex-row justify-center items-center gap-12 md:gap-24">
                        <div class="text-center group">
                            <span class="block text-6xl font-black text-audit-navy mb-2 group-hover:scale-110 transition-transform" id="score-display">0%</span>
                            <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">Aproveitamento</span>
                        </div>
                        <div class="h-16 w-px bg-gray-100 hidden md:block"></div>
                        <div class="text-center group">
                            <span class="block text-6xl font-black text-slate-700 mb-2 group-hover:scale-110 transition-transform" id="correct-count">0/0</span>
                            <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">Questões Corretas</span>
                        </div>
                    </div>
                    
                    <div class="bg-slate-50 p-6 border-t border-gray-100 flex flex-wrap justify-center gap-4 no-print">
                        <button onclick="shareResult()" class="px-5 py-2.5 bg-white border border-gray-200 text-slate-600 rounded-xl hover:text-audit-navy hover:border-audit-navy hover:shadow-md transition font-bold text-sm flex items-center gap-2">
                            <i class="fa-solid fa-share-nodes"></i> Compartilhar
                        </button>
                        <button onclick="exportOptions()" class="px-5 py-2.5 bg-white border border-gray-200 text-slate-600 rounded-xl hover:text-audit-navy hover:border-audit-navy hover:shadow-md transition font-bold text-sm flex items-center gap-2">
                            <i class="fa-solid fa-file-pdf"></i> Baixar Relatório
                        </button>
                        <button onclick="location.reload()" class="px-5 py-2.5 bg-audit-navy text-white rounded-xl hover:bg-blue-900 transition font-bold text-sm flex items-center gap-2 shadow-lg shadow-blue-900/20">
                            <i class="fa-solid fa-rotate-right"></i> Novo Simulado
                        </button>
                    </div>
                </div>

                <div class="grid lg:grid-cols-12 gap-8">
                    
                    <!-- Desempenho por Tópico -->
                    <div class="lg:col-span-5 bg-white rounded-2xl shadow-sm border border-gray-200 p-8 h-fit">
                        <h3 class="font-display font-bold text-slate-800 mb-6 flex items-center gap-3 text-lg">
                            <div class="w-8 h-8 rounded-lg bg-audit-gold/10 text-audit-gold flex items-center justify-center"><i class="fa-solid fa-chart-pie"></i></div>
                            Análise por Tópico
                        </h3>
                        <div id="topic-breakdown" class="space-y-6">
                            <!-- Barras JS -->
                        </div>
                    </div>

                    <!-- Biblioteca Recomendada -->
                    <div class="lg:col-span-7 bg-white rounded-2xl shadow-sm border border-gray-200 p-8 h-fit">
                        <h3 class="font-display font-bold text-slate-800 mb-2 flex items-center gap-3 text-lg">
                            <div class="w-8 h-8 rounded-lg bg-audit-navy/10 text-audit-navy flex items-center justify-center"><i class="fa-solid fa-book-bookmark"></i></div>
                            Biblioteca Recomendada
                        </h3>
                        <p class="text-sm text-slate-400 mb-8 ml-11">Materiais selecionados baseados nos seus pontos de atenção.</p>
                        
                        <div id="library-cards" class="grid sm:grid-cols-2 gap-4">
                            <!-- Cards Injetados via JS -->
                        </div>
                    </div>
                </div>

                <!-- Gabarito -->
                <div class="mt-8 bg-white rounded-2xl shadow-sm border border-gray-200 p-8 print-visible">
                    <h3 class="font-display font-bold text-slate-800 mb-6 text-lg">Gabarito Comentado</h3>
                    <div id="detailed-gabarito" class="space-y-4">
                        <!-- JS -->
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- FOOTER MODULAR (Carregado via JS) -->
    <div id="footer-container" class="no-print bg-slate-900 text-slate-400 min-h-[120px] border-t border-slate-800">
         <div class="h-32 w-full flex items-center justify-center">
            <div class="h-8 w-32 bg-white/10 rounded animate-pulse"></div>
         </div>
    </div>

    <!-- MODAL IMPRESSAO -->
    <div id="print-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm hidden z-[60] flex items-center justify-center p-4 no-print animate-fade-in">
        <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-slide-up transform transition-all">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-bold text-audit-navy">Exportar Relatório</h3>
                <button onclick="document.getElementById('print-modal').classList.add('hidden')" class="text-slate-400 hover:text-slate-600"><i class="fa-solid fa-times"></i></button>
            </div>
            
            <div class="space-y-3 mb-8">
                <label class="flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:border-audit-gold hover:bg-yellow-50/50 transition group">
                    <input type="radio" name="print_opt" value="results" checked class="mr-4 w-4 h-4 accent-audit-navy">
                    <div>
                        <div class="font-bold text-slate-800 text-sm group-hover:text-audit-navy">Relatório de Desempenho</div>
                        <div class="text-xs text-slate-500 mt-1">Resultados, gráficos e gabarito detalhado</div>
                    </div>
                </label>
                <label class="flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:border-audit-gold hover:bg-yellow-50/50 transition group">
                    <input type="radio" name="print_opt" value="all" class="mr-4 w-4 h-4 accent-audit-navy">
                    <div>
                        <div class="font-bold text-slate-800 text-sm group-hover:text-audit-navy">Caderno de Questões</div>
                        <div class="text-xs text-slate-500 mt-1">Prova completa em branco para impressão</div>
                    </div>
                </label>
            </div>
            
            <div class="flex gap-3">
                <button onclick="document.getElementById('print-modal').classList.add('hidden')" class="flex-1 py-3 text-slate-500 hover:bg-gray-50 rounded-xl text-sm font-bold transition">Cancelar</button>
                <button onclick="confirmPrint()" class="flex-1 py-3 bg-audit-navy text-white rounded-xl hover:bg-blue-900 font-bold text-sm shadow-lg shadow-blue-900/20 transition flex items-center justify-center gap-2">
                    <i class="fa-solid fa-file-pdf"></i> Gerar PDF
                </button>
            </div>
        </div>
    </div>

    <!-- LÓGICA DA APLICAÇÃO -->
    <script>
        // --- CONFIGURAÇÃO DE RECURSOS EXTERNOS ---
        const RESOURCES = {
            headerHTML: 'https://auditeduca.com.br/assets/components/header.html',
            footerHTML: 'https://auditeduca.com.br/assets/components/footer.html',
            scripts: [
                'https://auditeduca.com.br/assets/js/utils.js', 
                'https://auditeduca.com.br/assets/js/console-cleaner.js'
            ]
        };

        async function loadHtmlComponent(url, elementId) {
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`Status ${response.status}`);
                const html = await response.text();
                const wrapper = document.getElementById(elementId);
                wrapper.innerHTML = html;
            } catch (e) {
                console.warn(`Erro no módulo ${elementId} (Fallback para modo standalone):`, e);
                // Fallback para Header caso falhe a conexão
                if(elementId === 'header-container') {
                    document.getElementById(elementId).innerHTML = `
                        <div class="h-20 max-w-7xl mx-auto flex items-center justify-between px-6 lg:px-8">
                            <div class="flex items-center gap-6">
                                <img src="https://auditeduca.com.br/assets/images/logotipo-audit-educa-default.webp" alt="AuditEduca" class="h-10 w-auto">
                                <div class="hidden md:block w-px h-8 bg-gray-200"></div>
                                <h1 class="hidden md:block text-audit-navy font-bold text-sm tracking-wide uppercase">Simulador CFC</h1>
                            </div>
                        </div>`;
                }
                // Fallback para Footer
                if(elementId === 'footer-container') {
                     document.getElementById(elementId).innerHTML = `
                        <div class="max-w-7xl mx-auto px-6 py-10 flex flex-col md:flex-row justify-between items-center gap-6">
                            <div class="flex items-center gap-4">
                                <span class="text-xs font-medium text-slate-500">Plataforma de Ensino Continuado</span>
                            </div>
                            <div class="text-xs text-center md:text-right text-slate-500">
                                <p>&copy; 2025 AuditEduca. Todos os direitos reservados.</p>
                            </div>
                        </div>`;
                }
            }
        }

        async function loadScript(url) {
            return new Promise((resolve) => {
                const script = document.createElement('script');
                script.src = url;
                script.onload = resolve;
                script.onerror = resolve; // Continua mesmo se falhar
                document.body.appendChild(script);
            });
        }

        // --- DATASET ATUALIZADO (com os novos tópicos) ---
        const fullExamData = [
            { id: 1, topic: "Língua Portuguesa Aplicada", text: "Os dicionários registram os diversos significados de um vocábulo; os dois textos abaixo definem o termo “contabilidade”... Sobre esses textos, assinale a afirmativa correta.", options: ["As definições começam sempre por uma palavra de conteúdo geral...", "Os termos “teórica e prática” e “cálculo e registro” são antônimos.", "Os termos entre parênteses mostram todos os tipos de entidades.", "As duas definições mostram o mesmo objetivo."], correct: 0 },
            { id: 2, topic: "Língua Portuguesa Aplicada", text: "As frases listadas nas opções a seguir foram reescritas de forma a eliminar-se o “que”. Assinale a frase em que a substituição foi feita de forma adequada.", options: ["Cabral, o criador do Brasil, merece homenagens.", "Caminha, o redator da carta, registrou o fato.", "As caravelas, navegadoras do oceano, resistiram a tempestades.", "A descoberta do Brasil, ocorrente em 1500, ficou na história."], correct: 1 },
            { id: 3, topic: "Matemática Financeira e Estatística", text: "A empresa Gama S.A. avalia um projeto... Considerando uma taxa de desconto de 10% ao ano, o payback do projeto está entre:", options: ["1 ano e 2 anos.", "2 anos e 3 anos.", "3 anos e 4 anos.", "4 anos e 5 anos."], correct: 1 },
            { id: 4, topic: "Matemática Financeira e Estatística", text: "A empresa VGF S.A. tomou um empréstimo... Taxa de 20% ao mês. O valor das prestações mensais será de:", options: ["R$ 4.853,33.", "R$ 6.400,00.", "R$ 6.912,00.", "R$ 7.280,00."], correct: 2 },
            { id: 5, topic: "Contabilidade Aplicada ao Setor Público", text: "Lei nº 14.133... Princípios: I. Impessoalidade; II. Transparência; III. Racionalidade; IV. Probidade. Estão listados no Art. 5º:", options: ["I e IV.", "II e III.", "I, II e IV.", "I, II, III e IV."], correct: 2 },
            { id: 6, topic: "Noções de Direito e Legislação Aplicada", text: "Definição legal de tributo no CTN. Assinale a opção correta.", options: ["Prestação voluntária...", "Sanção de ato ilícito...", "Prestação compulsória em bens...", "Prestação pecuniária compulsória, em moeda..."], correct: 3 },
            { id: 7, topic: "Noções de Direito e Legislação Aplicada", text: "LC 123/2006. Definição de ME e EPP. Assinale a correta.", options: ["ME <= 120k; EPP <= 1.2M", "ME <= 360k; EPP <= 4.8M", "ME <= 81k; EPP <= 4.8M", "Limites fixados anualmente."], correct: 1 },
            { id: 8, topic: "Legislação e Ética Profissional", text: "NBC PG 01. Prática de divulgação eticamente correta:", options: ["Prometer redução garantida.", "Comparar preços.", "Divulgar clientes sem autorização.", "Expor conhecimento técnico."], correct: 3 },
            { id: 9, topic: "Legislação e Ética Profissional", text: "NBC PG 100. Habilidade para explicar dados a gestores com dificuldade:", options: ["Escuta ativa.", "Clareza na exposição.", "Revisar legislação.", "Ignorar dúvidas."], correct: 1 }
        ];

        // --- ESTADO ---
        let activeExamData = [];
        let currentQIndex = 0;
        let userAnswers = {};
        let bookmarked = {};
        let timeRemaining = 4 * 60 * 60;
        let timerInterval;

        // --- SETUP ---
        document.addEventListener('DOMContentLoaded', async () => {
            // Inicializa ícones
            if (window.lucide) lucide.createIcons();

            // Carrega componentes externos
            await Promise.all([
                loadHtmlComponent(RESOURCES.headerHTML, 'header-container'),
                loadHtmlComponent(RESOURCES.footerHTML, 'footer-container')
            ]);
            
            // Carrega scripts externos
            for (const scriptUrl of RESOURCES.scripts) {
                await loadScript(scriptUrl);
            }
            
            // Slider Logic
            const slider = document.getElementById('q-range');
            const display = document.getElementById('q-count-display');
            slider.max = fullExamData.length;
            
            slider.addEventListener('input', (e) => {
                display.textContent = e.target.value;
            });
        });

        function startSetup() {
            const count = parseInt(document.getElementById('q-range').value);
            activeExamData = fullExamData.slice(0, count);
            
            // Transição de Views
            document.getElementById('view-home').classList.add('hidden');
            document.getElementById('view-exam').classList.remove('hidden');
            document.getElementById('view-exam').classList.add('flex'); // Assegura flexbox
            document.getElementById('exam-toolbar').classList.remove('hidden');
            
            // Config Sidebar
            if(window.innerWidth >= 1024) {
                 document.getElementById('exam-sidebar').classList.remove('hidden');
                 document.getElementById('exam-sidebar').classList.add('flex');
            }
            
            renderSidebar();
            startTimer();
            loadQuestion(0);
        }

        function toggleSidebar() {
            const sb = document.getElementById('exam-sidebar');
            sb.classList.toggle('hidden');
            sb.classList.toggle('flex');
            sb.classList.toggle('-translate-x-full'); // Animação mobile
        }

        // --- ENGINE ---
        function loadQuestion(index) {
            currentQIndex = index;
            const data = activeExamData[index];
            
            // Texto e Metadados
            document.getElementById('q-number-circle').textContent = data.id;
            document.getElementById('q-text').textContent = data.text;
            document.getElementById('topic-badge').textContent = data.topic;
            
            // Mobile Update
            document.getElementById('mobile-q-num').textContent = data.id;

            // Bookmark UI
            const bmBtn = document.getElementById('btn-bookmark');
            bmBtn.innerHTML = bookmarked[data.id] ? '<i class="fa-solid fa-bookmark"></i>' : '<i class="fa-regular fa-bookmark"></i>';
            bmBtn.classList.toggle('text-audit-gold', !!bookmarked[data.id]);

            // Opções
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            const labels = ['A', 'B', 'C', 'D'];

            data.options.forEach((opt, idx) => {
                const isChecked = userAnswers[data.id] === idx;
                const wrapper = document.createElement('label');
                wrapper.className = "block cursor-pointer group";
                wrapper.innerHTML = `
                    <input type="radio" name="q_option" class="option-radio hidden" value="${idx}" ${isChecked ? 'checked' : ''} onchange="selectAnswer(${data.id}, ${idx})">
                    <div class="flex items-start gap-4 p-5 rounded-xl border transition-all ${isChecked ? 'border-audit-gold bg-yellow-50 shadow-sm' : 'border-gray-200 bg-white hover:border-audit-blue hover:shadow-md'}">
                        <div class="radio-circle mt-0.5 w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center flex-shrink-0 transition-colors bg-white text-xs font-bold text-slate-400 group-hover:text-audit-blue">${labels[idx]}</div>
                        <div class="flex-1 text-slate-600 text-sm font-medium leading-relaxed group-hover:text-slate-900">${opt}</div>
                    </div>
                `;
                container.appendChild(wrapper);
            });

            // Botão Próximo/Finalizar
            const btnNext = document.getElementById('btn-next');
            if (index === activeExamData.length - 1) {
                btnNext.innerHTML = 'Finalizar <i class="fa-solid fa-check ml-2"></i>';
                btnNext.classList.remove('bg-audit-navy');
                btnNext.classList.add('bg-green-600', 'hover:bg-green-700');
                btnNext.onclick = finishExam;
            } else {
                btnNext.innerHTML = 'Próxima <i class="fa-solid fa-arrow-right ml-2"></i>';
                btnNext.classList.add('bg-audit-navy');
                btnNext.classList.remove('bg-green-600', 'hover:bg-green-700');
                btnNext.onclick = nextQuestion;
            }

            // Estado Botão Anterior
            const btnPrev = document.getElementById('btn-prev');
            btnPrev.disabled = index === 0;
            btnPrev.classList.toggle('opacity-30', index === 0);
            
            updateSidebar();
        }

        function selectAnswer(qId, idx) {
            userAnswers[qId] = idx;
            playSound('click');
            updateSidebar();
        }

        function updateSidebar() {
            activeExamData.forEach((q, idx) => {
                const btn = document.getElementById(`sidebar-q-${q.id}`);
                if (!btn) return;
                
                let cls = "w-full aspect-square rounded-lg border text-xs font-bold flex items-center justify-center transition-all cursor-pointer ";
                
                // Estados do botão do mapa
                if (idx === currentQIndex) {
                    cls += "bg-audit-navy text-white border-audit-navy shadow-lg shadow-blue-900/20 scale-105";
                } else if (userAnswers[q.id] !== undefined) {
                    cls += "bg-blue-50 text-audit-blue border-blue-200";
                } else {
                    cls += "bg-white text-slate-400 border-gray-100 hover:border-audit-gold hover:text-audit-gold";
                }
                
                if (bookmarked[q.id]) cls += " ring-2 ring-audit-gold ring-offset-1";
                btn.className = cls;
            });
        }

        function renderSidebar() {
            const map = document.getElementById('question-map');
            map.innerHTML = '';
            activeExamData.forEach((q, idx) => {
                const btn = document.createElement('div');
                btn.id = `sidebar-q-${q.id}`;
                btn.textContent = q.id;
                btn.onclick = () => { loadQuestion(idx); };
                map.appendChild(btn);
            });
            updateSidebar();
        }

        // --- NAVIGATION ---
        function nextQuestion() { if(currentQIndex < activeExamData.length - 1) loadQuestion(currentQIndex + 1); }
        function prevQuestion() { if(currentQIndex > 0) loadQuestion(currentQIndex - 1); }
        function toggleBookmark() {
            const id = activeExamData[currentQIndex].id;
            bookmarked[id] = !bookmarked[id];
            loadQuestion(currentQIndex);
        }

        // --- RESULTS ---
        function finishExam() {
            clearInterval(timerInterval);
            playSound('success');
            
            document.getElementById('view-exam').classList.add('hidden');
            document.getElementById('exam-sidebar').classList.add('hidden');
            document.getElementById('exam-sidebar').classList.remove('flex');
            document.getElementById('view-results').classList.remove('hidden');
            document.getElementById('exam-toolbar').classList.add('hidden');
            
            // Calculate Scores
            let correct = 0;
            let topicStats = {};
            
            activeExamData.forEach(q => {
                if(!topicStats[q.topic]) topicStats[q.topic] = { total: 0, correct: 0 };
                topicStats[q.topic].total++;
                
                if(userAnswers[q.id] === q.correct) {
                    correct++;
                    topicStats[q.topic].correct++;
                }
            });

            const percent = Math.round((correct / activeExamData.length) * 100);
            
            // Animação dos Números
            animateValue("score-display", 0, percent, 1500, "%");
            document.getElementById('correct-count').textContent = `${correct}/${activeExamData.length}`;
            
            const phrases = [
                "Excelente desempenho! Sua dedicação é notável.",
                "Bom trabalho! Foque nos pontos de melhoria para alcançar a excelência.",
                "Não desista! A persistência é o caminho da aprovação.",
                "Auditoria requer precisão. Revise os conceitos fundamentais."
            ];
            document.getElementById('motivational-phrase').textContent = `"${phrases[Math.floor(Math.random() * phrases.length)]}"`;

            // Gerar Cards
            const topicContainer = document.getElementById('topic-breakdown');
            const libContainer = document.getElementById('library-cards');
            topicContainer.innerHTML = '';
            libContainer.innerHTML = '';

            // --- BIBLIOTECA COMPLETA (a-m) ---
            const libraryContent = {
                "Língua Portuguesa Aplicada": { title: "Gramática e Interpretação FGV", icon: "fa-pen-nib", color: "text-rose-600", bg: "bg-rose-50" },
                "Matemática Financeira e Estatística": { title: "HP12c e Estatística Essencial", icon: "fa-chart-line", color: "text-orange-600", bg: "bg-orange-50" },
                "Noções de Direito e Legislação Aplicada": { title: "Resumo Jurídico Contábil", icon: "fa-gavel", color: "text-indigo-600", bg: "bg-indigo-50" },
                "Legislação e Ética Profissional": { title: "Código de Ética Comentado", icon: "fa-shield-halved", color: "text-purple-600", bg: "bg-purple-50" },
                "Teoria da Contabilidade": { title: "Fundamentos Teóricos", icon: "fa-lightbulb", color: "text-amber-600", bg: "bg-amber-50" },
                "Princípios de Contabilidade e Normas Brasileiras de Contabilidade": { title: "Normas Brasileiras (NBCs)", icon: "fa-file-contract", color: "text-emerald-600", bg: "bg-emerald-50" },
                "Contabilidade Geral": { title: "Demonstrações Contábeis", icon: "fa-building-columns", color: "text-audit-navy", bg: "bg-blue-100" },
                "Contabilidade de Custos": { title: "Gestão de Custos e Preços", icon: "fa-tags", color: "text-cyan-600", bg: "bg-cyan-50" },
                "Contabilidade Gerencial": { title: "Análise de Indicadores", icon: "fa-chess-rook", color: "text-teal-600", bg: "bg-teal-50" },
                "Contabilidade Aplicada ao Setor Público": { title: "MCASP e LRF", icon: "fa-landmark", color: "text-slate-600", bg: "bg-slate-100" },
                "Controladoria": { title: "Planejamento e Controle", icon: "fa-bullseye", color: "text-red-600", bg: "bg-red-50" },
                "Auditoria Contábil": { title: "Procedimentos de Auditoria", icon: "fa-magnifying-glass", color: "text-audit-gold", bg: "bg-yellow-50" },
                "Perícia Contábil": { title: "Laudos e Pareceres", icon: "fa-fingerprint", color: "text-violet-600", bg: "bg-violet-50" }
            };

            for(const [topic, stats] of Object.entries(topicStats)) {
                const p = Math.round((stats.correct/stats.total)*100);
                const color = p >= 70 ? 'bg-green-500' : (p >= 50 ? 'bg-yellow-500' : 'bg-red-500');
                
                topicContainer.innerHTML += `
                    <div>
                        <div class="flex justify-between text-xs font-bold text-slate-600 mb-2">
                            <span>${topic}</span>
                            <span>${p}%</span>
                        </div>
                        <div class="h-2.5 w-full bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full ${color} transition-all duration-1000 ease-out" style="width: 0%" onload="this.style.width='${p}%'"></div>
                        </div>
                    </div>
                `;
                setTimeout(() => {
                    const bars = topicContainer.querySelectorAll(`.${color}`);
                    if(bars.length) bars[bars.length-1].style.width = `${p}%`;
                }, 100);

                // Mostra card se o desempenho for menor que 70%
                if(p < 70) {
                    const lib = libraryContent[topic] || { title: `Apostila de ${topic}`, icon: "fa-book", color: "text-audit-navy", bg: "bg-slate-50" };
                    libContainer.innerHTML += `
                        <div class="card-library bg-white p-4 rounded-xl flex items-center gap-4 cursor-pointer group">
                            <div class="w-12 h-12 rounded-lg ${lib.bg} ${lib.color} flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform">
                                <i class="fa-solid ${lib.icon} text-lg"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h4 class="font-bold text-sm text-slate-800 group-hover:text-audit-navy truncate">${lib.title}</h4>
                                <span class="text-[10px] text-slate-400 uppercase font-bold tracking-wider">Recomendado</span>
                            </div>
                            <div class="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center text-slate-300 group-hover:bg-audit-gold group-hover:text-white transition-colors">
                                <i class="fa-solid fa-chevron-right text-xs"></i>
                            </div>
                        </div>
                    `;
                }
            }
            
            if(libContainer.innerHTML === '') {
                 libContainer.innerHTML = `
                    <div class="col-span-2 text-center p-6 bg-slate-50 rounded-xl border border-dashed border-gray-300">
                        <i class="fa-solid fa-trophy text-audit-gold text-3xl mb-2"></i>
                        <p class="text-sm text-slate-500 font-medium">Parabéns! Você dominou todos os tópicos.</p>
                    </div>
                 `;
            }

            // Gabarito
            const gabaritoContainer = document.getElementById('detailed-gabarito');
            gabaritoContainer.innerHTML = '';
            const labels = ['A', 'B', 'C', 'D'];

            activeExamData.forEach(q => {
                const userIdx = userAnswers[q.id];
                const isCorrect = userIdx === q.correct;
                
                gabaritoContainer.innerHTML += `
                    <div class="p-5 rounded-xl border ${isCorrect ? 'border-green-200 bg-green-50/30' : 'border-red-200 bg-red-50/30'} transition-all hover:shadow-sm">
                        <div class="flex justify-between items-start mb-3">
                            <span class="text-[10px] font-bold uppercase tracking-widest px-2 py-1 rounded ${isCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">Questão ${q.id}</span>
                            ${isCorrect ? '<div class="w-6 h-6 rounded-full bg-green-500 text-white flex items-center justify-center"><i class="fa-solid fa-check text-xs"></i></div>' : '<div class="w-6 h-6 rounded-full bg-red-500 text-white flex items-center justify-center"><i class="fa-solid fa-xmark text-xs"></i></div>'}
                        </div>
                        <p class="text-sm text-slate-700 mb-4 font-medium leading-relaxed">${q.text}</p>
                        <div class="flex flex-col sm:flex-row gap-2 sm:gap-6 text-xs bg-white/50 p-3 rounded-lg border border-gray-100">
                            <span class="font-bold ${isCorrect ? 'text-green-700' : 'text-red-700'} flex items-center gap-2">
                                <i class="fa-solid fa-user"></i> Sua Resposta: ${userIdx !== undefined ? labels[userIdx] : 'Não respondida'}
                            </span>
                            <span class="font-bold text-green-700 flex items-center gap-2">
                                <i class="fa-solid fa-check-double"></i> Gabarito: ${labels[q.correct]}
                            </span>
                        </div>
                    </div>
                `;
            });
        }

        // --- UTILS ---
        function startTimer() {
            if(timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeRemaining--;
                const h = Math.floor(timeRemaining / 3600).toString().padStart(2,'0');
                const m = Math.floor((timeRemaining % 3600) / 60).toString().padStart(2,'0');
                const s = (timeRemaining % 60).toString().padStart(2,'0');
                document.getElementById('timer').textContent = `${h}:${m}:${s}`;
                if(timeRemaining <= 0) finishExam();
            }, 1000);
        }
        
        function animateValue(id, start, end, duration, suffix = "") {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start) + suffix;
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // Audio & TTS
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let soundOn = true;
        
        function playSound(type) {
            if(!soundOn) return;
            if(audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            const now = audioCtx.currentTime;
            
            if(type === 'click') {
                osc.frequency.setValueAtTime(600, now);
                osc.frequency.exponentialRampToValueAtTime(300, now + 0.1);
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
                osc.start(now); osc.stop(now + 0.1);
            } else if(type === 'success') {
                const notes = [523.25, 659.25, 783.99]; 
                notes.forEach((freq, i) => {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.connect(g);
                    g.connect(audioCtx.destination);
                    o.type = 'sine';
                    o.frequency.setValueAtTime(freq, now + (i*0.1));
                    g.gain.setValueAtTime(0.1, now + (i*0.1));
                    g.gain.exponentialRampToValueAtTime(0.001, now + (i*0.1) + 0.5);
                    o.start(now + (i*0.1));
                    o.stop(now + (i*0.1) + 0.5);
                });
            }
        }
        
        function toggleSound() { 
            soundOn = !soundOn; 
            const btn = document.getElementById('btn-sound');
            if(soundOn) {
                btn.classList.remove('text-gray-400');
                btn.classList.add('text-audit-navy');
                btn.innerHTML = '<i class="fa-solid fa-volume-high"></i>';
            } else {
                btn.classList.add('text-gray-400');
                btn.classList.remove('text-audit-navy');
                btn.innerHTML = '<i class="fa-solid fa-volume-xmark"></i>';
            }
        }
        
        function readQuestion() {
            window.speechSynthesis.cancel();
            const q = activeExamData[currentQIndex];
            const text = `Questão número ${q.id}. Tópico: ${q.topic}. ${q.text}. Alternativas. Letra A: ${q.options[0]}. Letra B: ${q.options[1]}. Letra C: ${q.options[2]}. Letra D: ${q.options[3]}`;
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'pt-BR';
            u.rate = 1.1; 
            window.speechSynthesis.speak(u);
        }

        // Export Functions
        function exportOptions() { document.getElementById('print-modal').classList.remove('hidden'); }
        
        function confirmPrint() {
            const opt = document.querySelector('input[name="print_opt"]:checked').value;
            document.getElementById('print-modal').classList.add('hidden');
            
            const home = document.getElementById('view-home');
            const exam = document.getElementById('view-exam');
            const res = document.getElementById('view-results');
            const sb = document.getElementById('exam-sidebar');
            const tb = document.getElementById('exam-toolbar');
            const header = document.getElementById('header-container');
            const footer = document.getElementById('footer-container');

            // Hide for print
            home.classList.add('hidden');
            exam.classList.add('hidden');
            res.classList.add('hidden');
            sb.classList.add('hidden');
            tb.classList.add('hidden');
            header.classList.add('hidden'); 
            footer.classList.add('hidden');

            if(opt === 'results') {
                 if(document.getElementById('score-display').textContent === "0%") {
                    alert("Complete a prova para gerar o relatório.");
                    res.classList.remove('hidden');
                    header.classList.remove('hidden');
                    footer.classList.remove('hidden');
                    return;
                }
                res.classList.remove('hidden');
                setTimeout(() => {
                    window.print();
                    // Restore
                    header.classList.remove('hidden');
                    footer.classList.remove('hidden');
                }, 500);
            } else {
                const printDiv = document.createElement('div');
                printDiv.className = 'max-w-4xl mx-auto p-10 bg-white text-black font-sans';
                printDiv.innerHTML = `
                    <div class="text-center mb-10 border-b-2 border-black pb-6">
                        <h1 class="text-3xl font-bold uppercase mb-2">Simulado CFC 2025.2</h1>
                        <p class="text-sm">Caderno de Questões - AuditEduca</p>
                    </div>
                `;
                
                activeExamData.forEach(q => {
                    printDiv.innerHTML += `
                        <div class="mb-8 break-inside-avoid">
                            <div class="flex items-baseline gap-2 mb-2">
                                <span class="font-bold text-lg">Questão ${q.id}</span>
                                <span class="text-xs uppercase font-bold text-gray-500 border border-gray-300 px-2 py-0.5 rounded">${q.topic}</span>
                            </div>
                            <p class="mb-4 text-justify leading-relaxed">${q.text}</p>
                            <div class="ml-4 space-y-2">
                                <div class="flex gap-2"><span class="font-bold">(A)</span> <p>${q.options[0]}</p></div>
                                <div class="flex gap-2"><span class="font-bold">(B)</span> <p>${q.options[1]}</p></div>
                                <div class="flex gap-2"><span class="font-bold">(C)</span> <p>${q.options[2]}</p></div>
                                <div class="flex gap-2"><span class="font-bold">(D)</span> <p>${q.options[3]}</p></div>
                            </div>
                        </div>
                    `;
                });
                
                document.body.appendChild(printDiv);
                window.print();
                document.body.removeChild(printDiv);
                
                // Restore
                if(Object.keys(userAnswers).length > 0) res.classList.remove('hidden');
                else {
                    exam.classList.remove('hidden');
                    tb.classList.remove('hidden');
                }
                header.classList.remove('hidden');
                footer.classList.remove('hidden');
                if(window.innerWidth >= 1024) document.getElementById('exam-sidebar').classList.remove('hidden');
            }
        }
    </script>
</body>
</html>